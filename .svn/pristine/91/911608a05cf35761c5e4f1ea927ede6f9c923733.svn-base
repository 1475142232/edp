package com.edp.admin.data;

import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;

import javax.servlet.http.HttpSession;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.ResponseBody;





























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































import com.edp.serviceI.data.DataServiceI;
import com.edp.serviceI.dto.DataInfoDto;
import com.edp.serviceI.dto.UserInfoDto;
import com.google.gson.Gson;

/**
 * 
 * @author zhang_cancan
 * 2016-9-5
 *
 */
@Controller
@RequestMapping("DataController")
public class DataController {
	
	@Autowired
	private DataServiceI dataServiceI;
	private static final Logger LOGGER = LoggerFactory.getLogger(DataController.class);
	private Gson gson = new Gson();
	
	
	/**
	 * 查询
	 * @time 2016/9/5
     * @author zhang_cancan
	 */
	@RequestMapping(value = "/findAllData.action" , method = { RequestMethod.GET,RequestMethod.POST })
	@ResponseBody
	public String findAllData(String teamId, HttpSession session){
		UserInfoDto userDto=(UserInfoDto)session.getAttribute("user");
		List<DataInfoDto> data=dataServiceI.findAllData(teamId,userDto.getId());
		return gson.toJson(data);
	}
	
	
	/**
	 * 添加
	 * @time 2016/9/5
     * @author zhang_cancan
	 */
	@RequestMapping(value = "/addData.action" , method = { RequestMethod.GET,RequestMethod.POST })
	@ResponseBody
	public String addData(DataInfoDto dto, HttpSession session){
		 Date today = new Date();
	     SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
	     UserInfoDto userDto=(UserInfoDto)session.getAttribute("user");
	     dto.setDataCreat(userDto.getUserName());
	     dto.setDataCreattime(sdf.format(today));
	     dto.setDataState("01");
	     dataServiceI.addData(dto);
	     return gson.toJson("0000");
	}
	
	
	/**
	 * 修改
	 * @time 2016/9/5
     * @author zhang_cancan
	 */
	@RequestMapping(value = "/editData.action" , method = { RequestMethod.GET,RequestMethod.POST })
	@ResponseBody
	public String editData(DataInfoDto dto){
		dataServiceI.editData(dto);
		return gson.toJson("0000");
	}
	
	/**
	 * 单个查询
	 * @time 2016/9/6
     * @author zhang_cancan
	 */
	@RequestMapping(value = "/findDataById.action" , method = { RequestMethod.GET,RequestMethod.POST })
	@ResponseBody
	public String findDataById(DataInfoDto dto){
		dto=dataServiceI.findDataById(dto);
		return gson.toJson(dto);
	}
	/**
	 * 根据项目id查询表
	 * @time 2016/9/21
	 * @author zhang_cancan
	 * 
	 */
	@RequestMapping(value = "/findDataByproductId.action" , method = { RequestMethod.GET,RequestMethod.POST })
	@ResponseBody
	public String findDataByproductId(String productId){
		List<DataInfoDto> data=dataServiceI.findDataByproductId(productId);
	    return gson.toJson(data);
	}
}
